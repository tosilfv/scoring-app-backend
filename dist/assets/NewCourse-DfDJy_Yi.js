import{r as d,A as I,u as S,R as e,L as T,s as A}from"./index-2bMJbr3r.js";import{u as C,I as c,V as p,b as R}from"./Input-B4Jn6B2e.js";import{u as V,E as H,B as E}from"./ErrorModal-CcmeLWGh.js";/* empty css                   */const F=()=>{const[u,b]=d.useState(0),[s,f]=d.useState([u]),g=d.useContext(I),v=S(),{isLoading:h,error:y,sendRequest:L,clearError:w}=V(),[o,i]=C({title:{value:"",isValid:!1},description:{value:"",isValid:!1}},!1),N=async t=>{t.preventDefault();let a=[],r="",m="";for(let l=0;l<t.target.length;l++)for(let n=0;n<t.target.length;n++)t.target[n].id===`labname${l}`&&(r=t.target[n].value),t.target[n].id===`labpassword${l}`&&(m=t.target[n].value,a.push({name:r,password:m}),r="",m="");try{await L("https://scoring-app-backend.onrender.com/api/courses","POST",JSON.stringify({title:o.inputs.title.value,description:o.inputs.description.value,labs:a}),{Authorization:"Bearer "+g.token,"Content-Type":"application/json"}),v("/courses/all")}catch(l){console.log("err courseSubmitHandler: ",l)}},x=async t=>{t.preventDefault();const a=u+1,r=[...s,a];b(a),f(r)},D=async t=>{if(t.preventDefault(),s.length>1){const a=u-1;b(a);const r=s.slice(0,-1);f(r),o.isValid=!0}};return e.createElement(e.Fragment,null,g.isAdmin&&e.createElement(e.Fragment,null,e.createElement(H,{error:y,onClear:w}),e.createElement("form",{className:"course-form",onSubmit:N},h&&e.createElement(T,{asOverlay:!0}),e.createElement(c,{id:"title",placeholder:"title",element:"input",type:"text",label:"Title",validators:[p()],errorText:"Please enter a valid title.",onInput:i}),e.createElement(c,{id:"description",placeholder:"description",element:"textarea",label:"Description",validators:[R(5)],errorText:"Please enter a valid description (at least 5 characters).",onInput:i}),Array.from(s).map(t=>e.createElement(e.Fragment,{key:t},e.createElement("div",{style:A.main},"LAB",t),e.createElement(c,{id:`labname${t}`,placeholder:"lab name",element:"input",label:"Lab name",validators:[p()],errorText:"Please enter a valid lab name.",onInput:i}),e.createElement(c,{id:`labpassword${t}`,placeholder:"lab password",element:"input",label:"Lab password",validators:[p()],errorText:"Please enter a valid lab password.",onInput:i}))),e.createElement("div",{style:A.button},e.createElement(E,{onClick:x},"+ ADD NEW LAB"),e.createElement(E,{onClick:D},"- REMOVE NEW LAB")),e.createElement(E,{type:"submit",disabled:!o.isValid},"ADD COURSE"))))};export{F as default};
