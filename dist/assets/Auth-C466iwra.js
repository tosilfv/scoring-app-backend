import{r as m,A as h,u as L,R as a,L as S}from"./index-2bMJbr3r.js";import{u as w,I as i,V as N,a as T,b}from"./Input-B4Jn6B2e.js";import{u as y,E as A,B as d}from"./ErrorModal-CcmeLWGh.js";import{C as O}from"./Card-DiVCC_vI.js";const x=()=>{const o=m.useContext(h),[s,c]=m.useState(!0),{isLoading:g,error:E,sendRequest:l,clearError:f}=y(),u=L(),[t,n,p]=w({email:{value:"",isValid:!1},password:{value:"",isValid:!1}},!1),v=()=>{s?p({...t.inputs,name:{value:"",isValid:!1}},!1):p({...t.inputs,name:void 0},t.inputs.email.isValid&&t.inputs.password.isValid),c(r=>!r)},I=async r=>{if(r.preventDefault(),s)try{const e=await l("https://scoring-app-backend.onrender.com/api/users/login","POST",JSON.stringify({email:t.inputs.email.value,password:t.inputs.password.value}),{"Content-Type":"application/json"});o.login(e.userId,e.token,e.isAdmin,e.userName),u("/profile")}catch(e){console.log("err authSubmitHandler isLoginMode: ",e)}else try{const e=await l("https://scoring-app-backend.onrender.com/api/users/signup","POST",JSON.stringify({email:t.inputs.email.value,password:t.inputs.password.value,name:t.inputs.name.value}),{"Content-Type":"application/json"});o.login(e.userId,e.token,e.isAdmin,e.userName),u("/profile")}catch(e){console.log("err authSubmitHandler !isLoginMode: ",e)}};return a.createElement(a.Fragment,null,a.createElement(A,{error:E,onClear:f}),a.createElement(O,{className:"authentication"},g&&a.createElement(S,{asOverlay:!0}),a.createElement("h2",null,"Login Required"),a.createElement("hr",null),a.createElement("form",{onSubmit:I},!s&&a.createElement(i,{element:"input",id:"name",type:"text",label:"Your Name",validators:[N()],errorText:"Please enter a name.",onInput:n}),a.createElement(i,{element:"input",id:"email",type:"email",label:"E-Mail",validators:[T()],errorText:"Please enter a valid email.",onInput:n}),a.createElement(i,{element:"input",id:"password",type:"password",label:"Password",validators:[b(5)],errorText:"Please enter a valid password, at least 5 characters.",onInput:n}),a.createElement(d,{type:"submit",name:"login",disabled:!t.isValid},s?"LOGIN":"SIGNUP")),a.createElement(d,{inverse:!0,name:"signup",onClick:v},"SWITCH TO ",s?"SIGNUP":"LOGIN")))};export{x as default};
