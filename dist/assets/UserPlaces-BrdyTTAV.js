import{r as d,A as g,R as e,a as h,b as P}from"./index-BAekq9sh.js";import{C as f}from"./Card-CDmk43Eg.js";import{u as C,E as D,M as y,B as c}from"./http-hook-BRc6Pwks.js";const I=t=>{const{isLoading:a,error:s,sendRequest:u,clearError:o}=C(),n=d.useContext(g),[i,r]=d.useState(!1),m=()=>{r(!0)},l=()=>{r(!1)},E=async()=>{r(!1);try{await u(`http://localhost:5000/api/places/${t.id}`,"DELETE",null,{Authorization:"Bearer "+n.token}),t.onDelete(t.id)}catch{}};return e.createElement(e.Fragment,null,e.createElement(D,{error:s,onClear:o}),e.createElement(y,{show:i,onCancel:l,header:"Are you sure?",footerClass:"place-item__modal-actions",footer:e.createElement(e.Fragment,null,e.createElement(c,{inverse:!0,onClick:l},"CANCEL"),e.createElement(c,{danger:!0,onClick:E},"DELETE"))},e.createElement("p",null,"Do you want to proceed and delete this place? Please note that it can't be undone thereafter.")),e.createElement("li",{className:"place-item"},e.createElement(f,{className:"place-item__content"},a&&e.createElement(h,{asOverlay:!0}),e.createElement("div",{className:"place-item__info"},e.createElement("h2",null,t.title),e.createElement("h3",null,t.address),e.createElement("p",null,t.description)),e.createElement("div",{className:"place-item__actions"},n.userId===t.creatorId&&e.createElement(c,{to:`/places/${t.id}`},"EDIT"),n.userId===t.creatorId&&e.createElement(c,{danger:!0,onClick:m},"DELETE")))))},L=t=>t.items.length===0?e.createElement("div",{className:"place-list center"},e.createElement(f,null,e.createElement("h2",null,"No places found. Maybe create one?"),e.createElement(c,{to:"/places/new"},"Share Place"))):e.createElement("ul",{className:"place-list"},t.items.map(a=>e.createElement(I,{key:a.id,id:a.id,image:a.image,title:a.title,description:a.description,address:a.address,creatorId:a.creator,coordinates:a.location,onDelete:t.onDeletePlace}))),v=()=>{const[t,a]=d.useState(),{isLoading:s,error:u,sendRequest:o,clearError:n}=C(),i=P().userId;d.useEffect(()=>{(async()=>{try{const l=await o(`http://localhost:5000/api/places/user/${i}`);a(l.places)}catch{}})()},[o,i]);const r=m=>{a(l=>l.filter(E=>E.id!==m))};return e.createElement(e.Fragment,null,e.createElement(D,{error:u,onClear:n}),s&&e.createElement("div",{className:"center"},e.createElement(h,null)),!s&&t&&e.createElement(L,{items:t,onDeletePlace:r}))};export{v as default};
