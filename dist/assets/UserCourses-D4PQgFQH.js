import{r as C,A as L,u as O,R as e,L as f,s as n,a as k}from"./index-Du1oE-vZ.js";import{u as g,E as b,M as _,B as i}from"./ErrorModal-CYgJFBS2.js";import{C as p}from"./Card-D6ymOBIv.js";const R=t=>{const[a,l]=C.useState(!1),{isLoading:h,error:m,sendRequest:u,clearError:d}=g(),o=C.useContext(L),E=O(),s=()=>{l(!0)},c=()=>{l(!1)},D=async()=>{l(!1);try{await u(`https://scoring-app-backend.onrender.com/api/courses/${t.id}`,"DELETE",null,{Authorization:"Bearer "+o.token}),t.onDelete(t.id)}catch(r){console.log("err: ",r)}},N=async(r,y,I)=>{r.preventDefault();let v;try{v=await u("https://scoring-app-backend.onrender.com/api/labs","POST",JSON.stringify({courseid:y,labid:I,labpassword:r.target.labInput.value}),{Authorization:"Bearer "+o.token,"Content-Type":"application/json"}),E("/")}catch(w){console.log("err labSubmitHandler: ",w)}},S=r=>{r.preventDefault()};return e.createElement(e.Fragment,null,e.createElement(b,{error:m,onClear:d}),e.createElement(_,{show:a,onCancel:c,header:"Are you sure?",footerClass:"course-item__modal-actions",footer:e.createElement(e.Fragment,null,e.createElement(i,{inverse:!0,onClick:c},"CANCEL"),e.createElement(i,{danger:!0,onClick:D},"OK"))},e.createElement("p",null,"Do you want to delete this course? This action cannot be undone.")),e.createElement("li",{className:"course-item"},e.createElement(p,{className:"course-item__content"},h&&e.createElement(f,{asOverlay:!0}),e.createElement("div",{className:"course-item__info"},e.createElement("h2",{style:n.main},"COURSE"),t.title,e.createElement("div",{style:n.yourcourses},e.createElement("h3",{style:n.main},"DESCRIPTION"),t.description),t.labs.map(r=>e.createElement("div",{key:r._id},e.createElement("form",{onSubmit:y=>N(y,t.id,r._id)},e.createElement("span",{style:n.labsubmit},"LAB"),e.createElement("span",{style:n.labsubmit},r.name),r.isCompleted?e.createElement("span",null,"< COMPLETED >"):e.createElement(e.Fragment,null,e.createElement("input",{style:n.labsubmit,onChange:S,placeholder:"enter lab password",type:"text",name:"labInput"}),e.createElement(i,{type:"submit"},"SUBMIT")))))),e.createElement("div",{className:"course-item__actions"},o.userId===t.creatorId&&e.createElement(i,{to:`/courses/${t.id}`},"EDIT"),o.userId===t.creatorId&&e.createElement(i,{danger:!0,onClick:s},"DELETE")))))},T=t=>t.items.length===0?e.createElement("div",{className:"course-list center"},e.createElement(p,null,e.createElement("h2",null,"No courses found."),e.createElement(i,{to:"/courses/new"},"New Course"))):e.createElement(e.Fragment,null,e.createElement("ul",{className:"course-list"},e.createElement("h2",{className:"course-list-header",style:n.main},"YOUR COURSES"),t.items.map(a=>e.createElement(R,{key:a.id,id:a.id,title:a.title,description:a.description,labs:a.labs,creatorId:a.creator,onDelete:t.onDeleteCourse}))),e.createElement("h2",{className:"course-list-header",style:n.main},"JOIN COURSES")),U=()=>{const[t,a]=C.useState(),{isLoading:l,error:h,sendRequest:m,clearError:u}=g(),d=k().userId;C.useEffect(()=>{(async()=>{let s;try{s=await m(`https://scoring-app-backend.onrender.com/api/courses/user/${d}`)}catch(c){console.log("err UserCourses: ",c)}s&&a(s.courses)})()},[m,d]);const o=E=>{a(s=>s.filter(c=>c.id!==E))};return e.createElement(e.Fragment,null,e.createElement(b,{error:h,onClear:u}),l&&e.createElement("div",{className:"center"},e.createElement(f,null)),!l&&t&&e.createElement(T,{items:t,onDeleteCourse:o}))};export{U as default};
