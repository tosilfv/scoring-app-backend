import{r as m,A as h,u as w,R as e,L}from"./index-xtEZ8P77.js";import{u as N,I as i,V as T,a as y,b as A}from"./Input-CE5mjgUN.js";import{u as S,E as O,B as d}from"./ErrorModal-CGldAPUT.js";import{C as b}from"./Card-m7_D8XDd.js";const P=()=>{const[s,c]=m.useState(!0),{isLoading:E,error:f,sendRequest:l,clearError:v}=S(),o=m.useContext(h),u=w(),[t,n,p]=N({email:{value:"",isValid:!1},password:{value:"",isValid:!1}},!1),I=()=>{s?p({...t.inputs,name:{value:"",isValid:!1}},!1):p({...t.inputs,name:void 0},t.inputs.email.isValid&&t.inputs.password.isValid),c(r=>!r)},g=async r=>{if(r.preventDefault(),s)try{const a=await l("https://scoring-app-backend.onrender.com/api/users/login","POST",JSON.stringify({email:t.inputs.email.value,password:t.inputs.password.value}),{"Content-Type":"application/json"});o.login(a.userId,a.token,a.isAdmin,a.userName),u("/profile")}catch{}else try{const a=await l("https://scoring-app-backend.onrender.com/api/users/signup","POST",JSON.stringify({email:t.inputs.email.value,password:t.inputs.password.value,name:t.inputs.name.value}),{"Content-Type":"application/json"});o.login(a.userId,a.token,a.isAdmin,a.userName),u("/profile")}catch{}};return e.createElement(e.Fragment,null,e.createElement(O,{error:f,onClear:v}),e.createElement(b,{className:"authentication"},E&&e.createElement(L,{asOverlay:!0}),e.createElement("h2",null,"Login Required"),e.createElement("hr",null),e.createElement("form",{onSubmit:g},!s&&e.createElement(i,{element:"input",id:"name",type:"text",label:"Your Name",validators:[T()],errorText:"Please enter a name.",onInput:n}),e.createElement(i,{element:"input",id:"email",type:"email",label:"E-Mail",validators:[y()],errorText:"Please enter a valid email.",onInput:n}),e.createElement(i,{element:"input",id:"password",type:"password",label:"Password",validators:[A(5)],errorText:"Please enter a valid password, at least 5 characters.",onInput:n}),e.createElement(d,{type:"submit",name:"login",disabled:!t.isValid},s?"LOGIN":"SIGNUP")),e.createElement(d,{inverse:!0,name:"signup",onClick:I},"SWITCH TO ",s?"SIGNUP":"LOGIN")))};export{P as default};
